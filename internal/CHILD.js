var data={
    "total_pages": 1,
    "current_page": "1",
    "total_records": 396,
    "records": [
        {
            "id": "5b7ddd0f5713637bba5ffeb7",
            "field_32": "<span class=\"5807f7bf106dd7292f92efc1\">BB9900-ULBL-A</span>",
            "field_32_raw": [
                {
                    "id": "5807f7bf106dd7292f92efc1",
                    "identifier": "BB9900-ULBL-A"
                }
            ],
            "field_240": "BlackBerry Bold 9900",
            "field_240_raw": "BlackBerry Bold 9900",
            "field_48": "$0.00",
            "field_48_raw": 0,
            "field_1524": "",
            "field_163": 33368,
            "field_163_raw": 33368
        },
        {
            "id": "597b93423ac504518661303c",
            "field_32": "<span class=\"58dd4bbe4c6d672b1cec3916\">BB9900-XXBL-A</span>",
            "field_32_raw": [
                {
                    "id": "58dd4bbe4c6d672b1cec3916",
                    "identifier": "BB9900-XXBL-A"
                }
            ],
            "field_240": "BlackBerry Bold 9900",
            "field_240_raw": "BlackBerry Bold 9900",
            "field_48": "$5.00",
            "field_48_raw": 5,
            "field_1524": 1,
            "field_1524_raw": 1,
            "field_163": 10996,
            "field_163_raw": 10996
        },
        {
            "id": "597b8e13a64bdb58371d22f3",
            "field_32": "<span class=\"58dd4bbe4c6d672b1cec3916\">BB9900-XXBL-A</span>",
            "field_32_raw": [
                {
                    "id": "58dd4bbe4c6d672b1cec3916",
                    "identifier": "BB9900-XXBL-A"
                }
            ],
            "field_240": "BlackBerry Bold 9900",
            "field_240_raw": "BlackBerry Bold 9900",
            "field_48": "$5.00",
            "field_48_raw": 5,
            "field_1524": 1,
            "field_1524_raw": 1,
            "field_163": 10994,
            "field_163_raw": 10994
        },
        {
            "id": "597b8da06fc5125a6d0f1afe",
            "field_32": "<span class=\"58dd4bbe4c6d672b1cec3916\">BB9900-XXBL-A</span>",
            "field_32_raw": [
                {
                    "id": "58dd4bbe4c6d672b1cec3916",
                    "identifier": "BB9900-XXBL-A"
                }
            ],
            "field_240": "BlackBerry Bold 9900",
            "field_240_raw": "BlackBerry Bold 9900",
            "field_48": "$5.00",
            "field_48_raw": 5,
            "field_1524": 1,
            "field_1524_raw": 1,
            "field_163": 10992,
            "field_163_raw": 10992
        },
        {
            "id": "597b8dcdb6184b5399e5e6b6",
            "field_32": "<span class=\"58dd4bbe4c6d672b1cec3916\">BB9900-XXBL-A</span>",
            "field_32_raw": [
                {
                    "id": "58dd4bbe4c6d672b1cec3916",
                    "identifier": "BB9900-XXBL-A"
                }
            ],
            "field_240": "BlackBerry Bold 9900",
            "field_240_raw": "BlackBerry Bold 9900",
            "field_48": "$5.00",
            "field_48_raw": 5,
            "field_1524": 1,
            "field_1524_raw": 1,
            "field_163": 10993,
            "field_163_raw": 10993
        },
        {
            "id": "5b75a751864adf6c0d65f641",
            "field_32": "<span class=\"58dd4bbe4c6d672b1cec3914\">BB9900-XXBL-B</span>",
            "field_32_raw": [
                {
                    "id": "58dd4bbe4c6d672b1cec3914",
                    "identifier": "BB9900-XXBL-B"
                }
            ],
            "field_240": "BlackBerry Bold 9900",
            "field_240_raw": "BlackBerry Bold 9900",
            "field_48": "$3.00",
            "field_48_raw": 3,
            "field_1524": "",
            "field_163": 32922,
            "field_163_raw": 32922
        },
        {
            "id": "5a8b75f7e7d48972e94feaa6",
            "field_32": "<span class=\"59076b385d383d21e670466d\">BB9930-ROBL-B</span>",
            "field_32_raw": [
                {
                    "id": "59076b385d383d21e670466d",
                    "identifier": "BB9930-ROBL-B"
                }
            ],
            "field_240": "BlackBerry Bold 9930",
            "field_240_raw": "BlackBerry Bold 9930",
            "field_48": "$0.00",
            "field_48_raw": 0,
            "field_1524": "",
            "field_163": 22670,
            "field_163_raw": 22670
        },
        {
            "id": "5b2446969dc725320dc7caf3",
            "field_32": "<span class=\"59b2d43354ee0f25537d51f5\">BB9930-VZBL-A</span>",
            "field_32_raw": [
                {
                    "id": "59b2d43354ee0f25537d51f5",
                    "identifier": "BB9930-VZBL-A"
                }
            ],
            "field_240": "BlackBerry Bold 9930",
            "field_240_raw": "BlackBerry Bold 9930",
            "field_48": "$0.01",
            "field_48_raw": 0.01,
            "field_1524": "",
            "field_163": 28730,
            "field_163_raw": 28730
        },
        {
            "id": "5b2449ac43999a31fd739574",
            "field_32": "<span class=\"59b2d43354ee0f25537d51f5\">BB9930-VZBL-A</span>",
            "field_32_raw": [
                {
                    "id": "59b2d43354ee0f25537d51f5",
                    "identifier": "BB9930-VZBL-A"
                }
            ],
            "field_240": "BlackBerry Bold 9930",
            "field_240_raw": "BlackBerry Bold 9930",
            "field_48": "$0.01",
            "field_48_raw": 0.01,
            "field_1524": "",
            "field_163": 28736,
            "field_163_raw": 28736
        },
        {
            "id": "5b2446e8416ed231fa206a1d",
            "field_32": "<span class=\"59b2d43354ee0f25537d51f2\">BB9930-VZBL-B</span>",
            "field_32_raw": [
                {
                    "id": "59b2d43354ee0f25537d51f2",
                    "identifier": "BB9930-VZBL-B"
                }
            ],
            "field_240": "BlackBerry Bold 9930",
            "field_240_raw": "BlackBerry Bold 9930",
            "field_48": "$0.01",
            "field_48_raw": 0.01,
            "field_1524": "",
            "field_163": 28732,
            "field_163_raw": 28732
        },
        {
            "id": "5b2445d89db39d320cad7894",
            "field_32": "<span class=\"59b2d43354ee0f25537d51f2\">BB9930-VZBL-B</span>",
            "field_32_raw": [
                {
                    "id": "59b2d43354ee0f25537d51f2",
                    "identifier": "BB9930-VZBL-B"
                }
            ],
            "field_240": "BlackBerry Bold 9930",
            "field_240_raw": "BlackBerry Bold 9930",
            "field_48": "$0.01",
            "field_48_raw": 0.01,
            "field_1524": "",
            "field_163": 28728,
            "field_163_raw": 28728
        }
      ]
};

var arr = data.records;



function uniq(a) {
    var seen = {};
    return a.filter(function(item) {
        return seen.hasOwnProperty(item) ? false : (seen[item] = true);
    });
}

var skuList = arr.map(function (B) {
  return B.field_32_raw[0].identifier;
});


var uSku = uniq(skuList);

console.log(uSku);

var finalList = [];

      for (var i = 0; i<uSku.length; i++){

        var costarr = arr.filter(function (A){
             return A.field_32_raw[0].identifier === uSku[i];
                            });

        var desc = costarr[0].field_240_raw;

        var quant =  costarr.length;

        var costtotal = costarr.reduce(function (accumulator, C){
                               return accumulator + C.field_48_raw;
                               },0);

        var avgcost = costtotal/quant;

        var Obj = {
          "SKU" : uSku[i],
          "DESC" : desc,
          "TCOST" : costtotal,
          "ACOST": avgcost,
          "QUANT": quant};
        finalList.push(Obj);
      }


      console.log(finalList);
